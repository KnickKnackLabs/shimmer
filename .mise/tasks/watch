#!/usr/bin/env bash
#MISE description="Watch the latest workflow run until completion"
#MISE usage="watch [agent]"

set -e

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
source "$SCRIPT_DIR/_agent-workflow"

AGENT="${1:-quick}"

WORKFLOW=$(get_workflow_for_agent "$AGENT") || exit 1

RUN_ID=$(gh run list --workflow="$WORKFLOW" --limit 1 --json databaseId -q '.[0].databaseId')
gh run watch "$RUN_ID"
